-- Update the create_demo_content_for_user function with the correct title
CREATE OR REPLACE FUNCTION public.create_demo_content_for_user(target_user_id uuid, target_team_id uuid)
RETURNS void
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
DECLARE
  demo_folder_id uuid;
  demo_rundown_id uuid;
BEGIN
  -- Create the Demo folder
  INSERT INTO rundown_folders (team_id, name, color, position, created_by)
  VALUES (target_team_id, 'Demo', '#8B5CF6', 0, target_user_id)
  RETURNING id INTO demo_folder_id;
  
  -- Generate a new UUID for the demo rundown
  demo_rundown_id := gen_random_uuid();
  
  -- Create the demo rundown with the complete template content
  INSERT INTO rundowns (
    id,
    user_id,
    team_id,
    folder_id,
    title,
    start_time,
    timezone,
    show_date,
    items,
    created_at,
    updated_at,
    last_updated_by,
    doc_version
  ) VALUES (
    demo_rundown_id,
    target_user_id,
    target_team_id,
    demo_folder_id,
    'DEMO RUNDOWN - Try Me Out!',
    '09:00:00',
    'America/New_York',
    CURRENT_DATE,
    '[{"id":"header_1751939845425_cy79eacen","type":"header","rowNumber":"A","name":"TOP OF SHOW","startTime":"","duration":"","endTime":"","elapsedTime":"","talent":"","script":"","gfx":"","video":"","images":"","notes":"","color":"","isFloating":false,"customFields":{},"segmentName":"A","calculatedRowNumber":"","calculatedStartTime":"09:02:00","calculatedEndTime":"09:02:00","calculatedElapsedTime":"00:02:00"},{"id":"77fb7e69-2909-4396-b5e9-364cfb2b9846","type":"regular","rowNumber":"1","name":"Show Open","startTime":"","duration":"02:00","endTime":"","elapsedTime":"00:00","talent":"Host: Alex","script":"[ALEX {Blue}] Welcome to the Clash of Champions! We''ve got an electrifying best-of-three showdown coming your way today, featuring two of the most hyped teams in the league. Buckle up — it''s going to be a wild ride!","gfx":"Logo animation, Show title screen","video":"Hype intro sizzle","images":"https://i.ytimg.com/vi/lPtFkGiYoqY/maxresdefault.jpg","notes":"","color":"","isFloating":false,"customFields":{"music":"Energetic Synth Opener"},"calculatedRowNumber":"1","calculatedStartTime":"09:00:00","calculatedEndTime":"09:02:00","calculatedElapsedTime":"00:00:00"},{"id":"977a3198-9abd-4953-a7d1-20640b04399d","type":"regular","rowNumber":"2","name":"Analyst Desk Intro","startTime":"","duration":"03:00","endTime":"","elapsedTime":"00:00","talent":"Host + Casters Moxie & Rekkz","script":"[ALEX {Blue}] Let''s get into the nitty-gritty with our expert casters. Moxie and Rekkz, walk us through the stakes and what to expect from today''s teams.","gfx":"Team logos, headshots","video":"Desk Cam Feed","images":"https://d359b212dt0ata.cloudfront.net/content/wp-content/uploads/2017/02/16122753/tips-for-esports-commentators-tastosis-sc2.jpg","notes":"","color":"","isFloating":false,"customFields":{"music":"LoL Instrumental Loop"},"calculatedRowNumber":"2","calculatedStartTime":"09:02:00","calculatedEndTime":"09:05:00","calculatedElapsedTime":"00:02:00"},{"id":"39430a5b-8642-4c56-a9ef-5069342587a8","type":"regular","rowNumber":"3","name":"Team A Introduction","startTime":"","duration":"02:00","endTime":"","elapsedTime":"00:00","talent":"Caster: Moxie","script":"[MOXIE {Green}] Team A has had an incredible run so far, dominating the group stage with near-perfect macro play and excellent synergy. Keep your eyes on their mid laner — he''s been a difference-maker all tournament long.","gfx":"Team A stats, roster gfx","video":"Team A Hype Video","images":"https://news.illinoisstate.edu/files/2022/10/RedbirdEsports2.jpg","notes":"","color":"#86efac","isFloating":false,"customFields":{"music":"Heroic Electronic Theme"},"calculatedRowNumber":"3","calculatedStartTime":"09:05:00","calculatedEndTime":"09:07:00","calculatedElapsedTime":"00:05:00"},{"id":"e9c3d4ae-d4b4-495f-8510-ac98a24c0e0e","type":"regular","rowNumber":"4","name":"Team B Introduction","startTime":"","duration":"02:00","endTime":"","elapsedTime":"00:00","talent":"Caster: Rekkz","script":"[REKKZ {Orange}] Meanwhile, Team B has clawed their way through the lower bracket and they''ve got momentum on their side. Their aggressive bot lane duo will definitely be a factor to watch today.","gfx":"Team B stats, player cards","video":"Team B Intro Package","images":"https://imageio.forbes.com/specials-images/imageserve/616d8c011587d9604661c1d2/Marcus-Lieder-G2-Esports-Valorant/0x0.jpg?format=jpg&crop=5760,3240,x0,y313,safe&width=960","notes":"","color":"","isFloating":false,"customFields":{"music":"Rising Rock Track"},"calculatedRowNumber":"4","calculatedStartTime":"09:07:00","calculatedEndTime":"09:09:00","calculatedElapsedTime":"00:07:00"},{"id":"header_1751939988191_bdyoqqh5l","type":"header","rowNumber":"A","name":"GAME 1","startTime":"","duration":"","endTime":"","elapsedTime":"","talent":"","script":"","gfx":"","video":"","images":"","notes":"","color":"","isFloating":false,"customFields":{}},{"id":"26e74ac2-667a-45e0-bbb0-22b5519d3702","type":"regular","rowNumber":"5","name":"Game 1 Intro","startTime":"","duration":"01:00","endTime":"","elapsedTime":"00:00","talent":"Host","script":"[ALEX {Blue}] Game 1 is moments away! Let''s set the stage and see who comes out swinging in this first clash of titans.","gfx":"Match countdown","video":"Match transition animation","images":"https://www.figma.com/design/L8u3SPqxEDa8vAxlafd6DB/FORMAT-GFX?node-id=0-1&t=6AMO5H3s5mTIHLyH-1","notes":"","color":"#93c5fd","isFloating":false,"customFields":{"music":"Match Start Theme"},"calculatedRowNumber":"5","calculatedStartTime":"09:09:00","calculatedEndTime":"09:10:00","calculatedElapsedTime":"00:09:00"},{"id":"49d216c1-a103-472e-934f-51e70acd56d3","type":"regular","rowNumber":"6","name":"Game 1 – Live","startTime":"","duration":"30:00","endTime":"","elapsedTime":"00:00","talent":"Casters","script":"[MOXIE {Green}] & [REKKZ {Orange}] Welcome to Game 1 of the Clash of Champions! Team A on blue side, Team B on red. Let''s see who sets the pace early!","gfx":"In-game overlays","video":"Live Game Feed","images":"https://t3.ftcdn.net/jpg/04/84/00/06/360_F_484000681_Ek5qjaX3PgJx86VzvpXZttLCg3dKVxUo.jpg","notes":"","color":"","isFloating":false,"customFields":{"music":"In-game Audio"},"calculatedRowNumber":"6","calculatedStartTime":"09:10:00","calculatedEndTime":"09:40:00","calculatedElapsedTime":"00:10:00"},{"id":"d06e4dbe-48d1-4556-afb6-d2865cbdf6ce","type":"regular","rowNumber":"7","name":"Game 1 Recap","startTime":"","duration":"04:00","endTime":"","elapsedTime":"00:00","talent":"Host + Casters","script":"[ALEX {Blue}] What a match! Team A takes Game 1 in commanding fashion, controlling objectives and closing out with textbook precision. Let''s break down the key plays.","gfx":"Scoreboard, replays","video":"Game 1 Highlights","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Lo-fi Recap Loop"},"calculatedRowNumber":"7","calculatedStartTime":"09:40:00","calculatedEndTime":"09:44:00","calculatedElapsedTime":"00:40:00"},{"id":"0c240b19-e263-4d25-8760-71d39d751c3d","type":"regular","rowNumber":"8","name":"Mid-Round Interview","startTime":"","duration":"03:00","endTime":"","elapsedTime":"00:00","talent":"Host + Team A Player","script":"[ALEX {Blue}] Joining us now is (PlayerName), the jungler for Team A. Congratulations on the win! Walk us through your early-game pathing and how you read the map so effectively.","gfx":"Interview L3","video":"Remote or Studio Interview","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Light Ambient Underscore"},"calculatedRowNumber":"8","calculatedStartTime":"09:44:00","calculatedEndTime":"09:47:00","calculatedElapsedTime":"00:44:00"},{"id":"header_1751939993022_bv774atre","type":"header","rowNumber":"A","name":"GAME 2","startTime":"","duration":"","endTime":"","elapsedTime":"","talent":"","script":"","gfx":"","video":"","images":"","notes":"","color":"","isFloating":false,"customFields":{}},{"id":"44ae57ac-5643-4c23-88a3-d25898e1e7fb","type":"regular","rowNumber":"9","name":"Game 2 Intro","startTime":"","duration":"01:00","endTime":"","elapsedTime":"00:00","talent":"Host","script":"[ALEX {Blue}] With Team A up 1-0, the pressure is on Team B. Let''s head into Game 2 and see if they can even the score.","gfx":"Match graphic: Game 2","video":"Transition to Game Feed","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Suspenseful Build"},"calculatedRowNumber":"9","calculatedStartTime":"09:47:00","calculatedEndTime":"09:48:00","calculatedElapsedTime":"00:47:00"},{"id":"73dee33c-93e6-4699-b811-2c25379b9282","type":"regular","rowNumber":"10","name":"Game 2 – Live","startTime":"","duration":"30:00","endTime":"","elapsedTime":"00:00","talent":"Casters","script":"[MOXIE {Green}] & [REKKZ {Orange}] Game 2 underway! Team B is out for revenge. Will they tie it up or fall to the sweep?","gfx":"In-game overlays","video":"Live Game Feed","images":"https://t3.ftcdn.net/jpg/04/25/60/24/360_F_425602403_RBxfj665nBun5e0BfbMzRgXeLwnXcv5u.jpg","notes":"","color":"","isFloating":false,"customFields":{"music":"In-game Audio"},"calculatedRowNumber":"10","calculatedStartTime":"09:48:00","calculatedEndTime":"10:18:00","calculatedElapsedTime":"00:48:00"},{"id":"270e4eb6-aab1-4535-9f40-668222908f9a","type":"regular","rowNumber":"11","name":"Game 2 Recap","startTime":"","duration":"04:00","endTime":"","elapsedTime":"00:00","talent":"Host + Casters","script":"[ALEX {Blue}] A huge bounce back by Team B! They adapted brilliantly and punished every overextension from Team A. Let''s look at how this series is shaping up.","gfx":"Scoreboard, Key Plays GFX","video":"Game 2 Highlights","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Tense Build & Resolve"},"calculatedRowNumber":"11","calculatedStartTime":"10:18:00","calculatedEndTime":"10:22:00","calculatedElapsedTime":"01:18:00"},{"id":"984b0601-c7a4-47cf-80f8-1f16ba16484d","type":"regular","rowNumber":"12","name":"Halftime Fun Segment","startTime":"","duration":"03:00","endTime":"","elapsedTime":"00:00","talent":"Host","script":"[ALEX {Blue}] While the teams prepare for the final showdown, let''s take a quick break with some fun — community tweets, memes, and fan predictions coming your way!","gfx":"Fan Tweets, Meme Graphics ","video":"Short comedic intermission","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Chill Midtempo Groove"},"calculatedRowNumber":"12","calculatedStartTime":"10:22:00","calculatedEndTime":"10:25:00","calculatedElapsedTime":"01:22:00"},{"id":"header_1751939997240_ztdj4245a","type":"header","rowNumber":"A","name":"GAME 3","startTime":"","duration":"","endTime":"","elapsedTime":"","talent":"","script":"","gfx":"","video":"","images":"","notes":"","color":"","isFloating":false,"customFields":{}},{"id":"770a900b-f810-4420-844b-174ccd3ebdd5","type":"regular","rowNumber":"13","name":"Game 3 Intro","startTime":"","duration":"01:00","endTime":"","elapsedTime":"00:00","talent":"Host","script":"[ALEX {Blue}] It''s all on the line now — Game 3. One game to crown the champions. Let''s get into it!","gfx":"Final Matchup Slate","video":"Transition Animation","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Epic Countdown"},"calculatedRowNumber":"13","calculatedStartTime":"10:25:00","calculatedEndTime":"10:26:00","calculatedElapsedTime":"01:25:00"},{"id":"796f529c-81b5-4b83-baef-8ddcd5b81ec4","type":"regular","rowNumber":"14","name":"Game 3 – Live","startTime":"","duration":"30:00","endTime":"","elapsedTime":"00:00","talent":"Casters ","script":"[MOXIE {Green}] & [REKKZ {Orange}] Here we go — the deciding game! The draft was spicy and both teams are locked in. May the better squad win!","gfx":"In-game overlays","video":"Live Game Feed","images":"https://resources.finalsite.net/images/v1629478453/usmk12org/yizzw0mr1escg58pmhvp/esports.png","notes":"","color":"","isFloating":false,"customFields":{"music":"In-game Audio"},"calculatedRowNumber":"14","calculatedStartTime":"10:26:00","calculatedEndTime":"10:56:00","calculatedElapsedTime":"01:26:00"},{"id":"1590433c-bd70-4921-bf7d-99aa2df68121","type":"regular","rowNumber":"15","name":"Game 3 Recap","startTime":"","duration":"04:00","endTime":"","elapsedTime":"00:00","talent":"Host + Casters","script":"[ALEX {Blue}] What a finale! Let''s relive the biggest moments from Game 3 and crown our MVP of the series.","gfx":"Final Scoreboard, MVP","video":"Game 3 Highlights","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Triumphant Electronic"},"calculatedRowNumber":"15","calculatedStartTime":"10:56:00","calculatedEndTime":"11:00:00","calculatedElapsedTime":"01:56:00"},{"id":"header_1751940005210_yjglodbzs","type":"header","rowNumber":"A","name":"BOTTOM OF SHOW","startTime":"","duration":"","endTime":"","elapsedTime":"","talent":"","script":"","gfx":"","video":"","images":"","notes":"","color":"","isFloating":false,"customFields":{}},{"id":"67b5e6a8-452e-42b5-b07d-42d19dbbddb9","type":"regular","rowNumber":"16","name":"Winner Interview","startTime":"","duration":"03:00","endTime":"","elapsedTime":"00:00","talent":"Host + Team B Player","script":"[ALEX {Blue}] We''re joined now by the captain of Team B — a well-earned victory and a thrilling reverse sweep. How are you feeling after such a clutch performance?","gfx":"Interview L3","video":"Player Interview Clip","images":"","notes":"","color":"","isFloating":false,"customFields":{"music":"Victory Theme"},"calculatedRowNumber":"16","calculatedStartTime":"11:00:00","calculatedEndTime":"11:03:00","calculatedElapsedTime":"02:00:00"},{"id":"09aa81e3-5c1e-491a-aa56-4f008295d708","type":"regular","rowNumber":"17","name":"Closing Segment","startTime":"","duration":"02:00","endTime":"","elapsedTime":"00:00","talent":"Host","script":"[ALEX {Blue}] That''s it for Clash of Champions! Thanks to our players, production team, and fans worldwide. We''ll see you next time for more epic League of Legends action!","gfx":"End Credits, Sponsor L3s ","video":"Event montage + slow-motion","images":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTy1d95UwKuW9ZYfBKyv-5iaIBKMeQW49ND0Q&s","notes":"","color":"","isFloating":false,"customFields":{"music":"Uplifting Outro"},"calculatedRowNumber":"17","calculatedStartTime":"11:03:00","calculatedEndTime":"11:05:00","calculatedElapsedTime":"02:03:00"}]'::jsonb,
    now(),
    now(),
    target_user_id,
    1
  );
END;
$$;